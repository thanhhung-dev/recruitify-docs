# Story 3.4: Job Seeker Application Status Visibility

**Status**: Draft

**Story**

As a job seeker,
I want to see if the status of my application changes,
so that I have visibility into where I stand in the hiring process.

**Acceptance Criteria**

1. When an employer updates an applicant's status (from Story 3.3), the new status is reflected on the job seeker's "My Applications" page.
2. For the MVP, the system will not send email or push notifications for status changes.
3. The status shown to the job seeker is a simplified, user-friendly version of the employer's internal status (e.g., "Interview" is displayed as "In Progress").

**Tasks / Subtasks**

- [ ] **Task 1: Create Status Mapping Utility (AC: 3)**
  - [ ] Subtask 1.1: Create `apps/web/src/utils/statusMapper.ts` utility file. [Source: architecture/10-frontend-architecture.md]
  - [ ] Subtask 1.2: Implement `mapApplicationStatusToDisplay(status: ApplicationStatus): string` function. [Source: AC 3]
  - [ ] Subtask 1.3: Map employer statuses to user-friendly labels: NEW → "Applied", UNDER_REVIEW → "Under Review", INTERVIEW → "In Progress", CLOSED → "Closed". [Source: AC 3]
  - [ ] Subtask 1.4: Add JSDoc comments explaining the mapping rationale. [Source: Code documentation]
  - [ ] Subtask 1.5: Export mapping constants for reuse across components. [Source: DRY principle]

- [ ] **Task 2: Create Status Display Configuration (AC: 3)**
  - [ ] Subtask 2.1: Define status display configuration object with label, color, and icon. [Source: Visual consistency]
  - [ ] Subtask 2.2: Configure colors: Applied (blue), Under Review (orange), In Progress (green), Closed (gray). [Source: Story 3.3 color scheme]
  - [ ] Subtask 2.3: Add optional icons for each status (CheckCircle, EyeOutlined, TeamOutlined, CloseCircle). [Source: Visual feedback]
  - [ ] Subtask 2.4: Create TypeScript type `StatusDisplayConfig` for type safety. [Source: architecture/17-coding-standards.md]

- [ ] **Task 3: Update MyApplicationDto Backend Mapping (AC: 1)**
  - [ ] Subtask 3.1: Verify `MyApplicationDto` in backend includes `status` field from `Application` entity. [Source: Story 3.1 and AC 1]
  - [ ] Subtask 3.2: Ensure `GET /api/v1/applications/my-applications` returns current status. [Source: AC 1]
  - [ ] Subtask 3.3: Verify `updatedAt` timestamp is included for status change tracking. [Source: Story 3.3 timestamp updates]
  - [ ] Subtask 3.4: No backend changes needed if Story 3.1 already includes status field. [Source: Verify existing implementation]

- [ ] **Task 4: Update Shared TypeScript Types for Display Status (AC: 3)**
  - [ ] Subtask 4.1: Update `packages/shared-types/application.ts` with display status type. [Source: architecture/17-coding-standards.md]
  - [ ] Subtask 4.2: Add `ApplicationStatusDisplay` type: `'Applied' | 'Under Review' | 'In Progress' | 'Closed'`. [Source: AC 3]
  - [ ] Subtask 4.3: Add helper type for status color mapping. [Source: Component reusability]

- [ ] **Task 5: Update ApplicationCard Component with Status Display (AC: 1, 3)**
  - [ ] Subtask 5.1: Update `apps/web/src/features/applications/ApplicationCard.tsx` from Story 3.1. [Source: Story 3.1 foundation]
  - [ ] Subtask 5.2: Import and use `mapApplicationStatusToDisplay()` function. [Source: AC 3]
  - [ ] Subtask 5.3: Update status badge to display user-friendly label instead of raw status. [Source: AC 3]
  - [ ] Subtask 5.4: Apply appropriate color scheme from status display config. [Source: Visual consistency]
  - [ ] Subtask 5.5: Add optional status icon to badge for enhanced visual feedback. [Source: UX best practice]
  - [ ] Subtask 5.6: Add tooltip showing last updated timestamp if status changed recently. [Source: Status change awareness]

- [ ] **Task 6: Update ApplicationsList Component with Status Filtering (AC: 1)**
  - [ ] Subtask 6.1: Update `apps/web/src/features/applications/ApplicationsList.tsx` from Story 3.1. [Source: Story 3.1 foundation]
  - [ ] Subtask 6.2: Ensure filter tabs use display status labels instead of raw statuses. [Source: AC 3]
  - [ ] Subtask 6.3: Update "Active" filter to include: Applied, Under Review, In Progress statuses. [Source: Filter logic]
  - [ ] Subtask 6.4: Update "Closed" filter to show only Closed status. [Source: Filter logic]
  - [ ] Subtask 6.5: Ensure list updates reactively when status changes occur. [Source: AC 1]

- [ ] **Task 7: Add Status Change Indicator (AC: 1)**
  - [ ] Subtask 7.1: Add "Recently Updated" badge to applications with status changed in last 7 days. [Source: Status change visibility]
  - [ ] Subtask 7.2: Compare `updatedAt` with current date to determine recency. [Source: Timestamp comparison]
  - [ ] Subtask 7.3: Use Ant Design `Badge` with "dot" variant for subtle indicator. [Source: architecture/3-tech-stack.md]
  - [ ] Subtask 7.4: Add animation/highlight effect for newly updated applications. [Source: Visual attention]
  - [ ] Subtask 7.5: Sort applications with recent updates to top of list. [Source: Priority display]

- [ ] **Task 8: Update ApplicationsStats Component with Status Breakdown (AC: 1, 3)**
  - [ ] Subtask 8.1: Update `apps/web/src/features/applications/ApplicationsStats.tsx` from Story 3.1. [Source: Story 3.1 foundation]
  - [ ] Subtask 8.2: Display stats using user-friendly status labels. [Source: AC 3]
  - [ ] Subtask 8.3: Show breakdown: X Applied, Y Under Review, Z In Progress, W Closed. [Source: Status visibility]
  - [ ] Subtask 8.4: Use color-coded stat cards matching status colors. [Source: Visual consistency]
  - [ ] Subtask 8.5: Calculate stats from applications array in store using display mapping. [Source: Client-side computation]

- [ ] **Task 9: Add Status Transition Timeline (Optional Enhancement)**
  - [ ] Subtask 9.1: Create `StatusTimeline.tsx` component to show status progression. [Source: Enhanced visibility]
  - [ ] Subtask 9.2: Use Ant Design `Timeline` component to visualize status changes. [Source: architecture/3-tech-stack.md]
  - [ ] Subtask 9.3: Display: Applied (date) → Under Review (date if changed) → In Progress (date if reached). [Source: Status history]
  - [ ] Subtask 9.4: Show in ApplicationCard detail view or expandable section. [Source: Progressive disclosure]
  - [ ] Subtask 9.5: Note: Full status history requires backend changes (future enhancement). [Source: MVP scope]

- [ ] **Task 10: Implement Auto-Refresh Mechanism (AC: 1)**
  - [ ] Subtask 10.1: Update `useMyApplicationsStore` to support periodic refresh. [Source: Story 3.1 store]
  - [ ] Subtask 10.2: Implement `refreshApplications()` action that re-fetches from API. [Source: AC 1]
  - [ ] Subtask 10.3: Add optional auto-refresh every 60 seconds when "My Applications" page is visible. [Source: Real-time updates without notifications]
  - [ ] Subtask 10.4: Use `useEffect` with interval and cleanup for auto-refresh. [Source: React patterns]
  - [ ] Subtask 10.5: Disable auto-refresh when page is not in focus to save resources. [Source: Performance]
  - [ ] Subtask 10.6: Add manual refresh button with loading indicator. [Source: User control]

- [ ] **Task 11: Add Status Change Empty State (AC: 2)**
  - [ ] Subtask 11.1: Since no notifications are sent, add informational message about status updates. [Source: AC 2]
  - [ ] Subtask 11.2: Add info banner: "Check back here regularly for updates on your applications." [Source: User education]
  - [ ] Subtask 11.3: Use Ant Design `Alert` component with info variant. [Source: architecture/3-tech-stack.md]
  - [ ] Subtask 11.4: Position banner prominently on first visit (dismissible). [Source: Onboarding UX]

- [ ] **Task 12: Create Status Explanation Modal (AC: 3)**
  - [ ] Subtask 12.1: Create `StatusExplanationModal.tsx` component. [Source: User education]
  - [ ] Subtask 12.2: Explain what each status means: Applied (submitted), Under Review (being evaluated), In Progress (interview stage), Closed (decision made). [Source: AC 3 clarification]
  - [ ] Subtask 12.3: Accessible via "What do these statuses mean?" link on My Applications page. [Source: Help UX]
  - [ ] Subtask 12.4: Use Ant Design `Modal` component. [Source: architecture/3-tech-stack.md]

- [ ] **Task 13: Implement Backend Unit Tests (AC: 1)**
  - [ ] Subtask 13.1: Verify existing test for `GET /api/v1/applications/my-applications` includes status field. [Source: Story 3.1 tests]
  - [ ] Subtask 13.2: Add test to verify status reflects most recent update from Story 3.3. [Source: AC 1]
  - [ ] Subtask 13.3: Add test to verify `updatedAt` timestamp is included in response. [Source: Status change tracking]
  - [ ] Subtask 13.4: Place tests in `apps/api/src/test/java/com/recruitify/service/ApplicationServiceTest.java`. [Source: architecture/16-testing-strategy.md]

- [ ] **Task 14: Implement Frontend Unit Tests (AC: 3)**
  - [ ] Subtask 14.1: Write unit test for `mapApplicationStatusToDisplay()` utility function. [Source: architecture/16-testing-strategy.md]
  - [ ] Subtask 14.2: Test all status mappings: NEW → "Applied", UNDER_REVIEW → "Under Review", INTERVIEW → "In Progress", CLOSED → "Closed". [Source: AC 3]
  - [ ] Subtask 14.3: Write unit test for `ApplicationCard` displaying user-friendly status. [Source: architecture/16-testing-strategy.md]
  - [ ] Subtask 14.4: Write unit test for status color configuration. [Source: Visual consistency]
  - [ ] Subtask 14.5: Place tests co-located: `statusMapper.test.ts`, `ApplicationCard.test.tsx`. [Source: architecture/16-testing-strategy.md]

- [ ] **Task 15: Implement Integration Tests (AC: 1, 3)**
  - [ ] Subtask 15.1: Write integration test verifying status updates flow from employer to job seeker. [Source: End-to-end validation]
  - [ ] Subtask 15.2: Simulate employer changing status via Story 3.3 endpoint. [Source: AC 1]
  - [ ] Subtask 15.3: Verify job seeker's `GET /api/v1/applications/my-applications` returns updated status. [Source: AC 1]
  - [ ] Subtask 15.4: Verify correct display label mapping. [Source: AC 3]

- [ ] **Task 16: Implement E2E Tests (AC: 1, 2, 3)**
  - [ ] Subtask 16.1: Create Playwright E2E test for job seeker viewing application status updates. [Source: architecture/16-testing-strategy.md]
  - [ ] Subtask 16.2: Test: Login as recruiter → Change applicant status to "Under Review". [Source: Story 3.3 integration]
  - [ ] Subtask 16.3: Test: Login as job seeker → Navigate to My Applications page. [Source: AC 1]
  - [ ] Subtask 16.4: Test: Verify application shows "Under Review" status (not raw "UNDER_REVIEW"). [Source: AC 3]
  - [ ] Subtask 16.5: Test: Change status to "Interview" → Verify job seeker sees "In Progress". [Source: AC 3]
  - [ ] Subtask 16.6: Test: Verify no notification/email is sent (AC 2 - passive check via logs). [Source: AC 2]
  - [ ] Subtask 16.7: Test: Verify "Recently Updated" indicator appears for status changes. [Source: Status change awareness]
  - [ ] Subtask 16.8: Test: Manual refresh button updates the list. [Source: User control]
  - [ ] Subtask 16.9: Place tests in `e2e/job-seeker-application-status-updates.spec.ts`. [Source: architecture/16-testing-strategy.md]

**Dev Notes**

**Previous Story Dependencies**: This story depends on:
- **Story 3.1** (My Applications Page): The UI foundation where statuses are displayed - `ApplicationCard`, `ApplicationsList`, `ApplicationsStats` components
- **Story 3.3** (Employer Applicant Management): Status update functionality that this story reflects on the job seeker side
- **Story 2.4** (Apply for a Job): The `Application` entity with `status` and `updatedAt` fields
- **Story 1.2** (Registration & Login): Authentication for job seekers to access their applications

This story completes the applicant status management loop by making status changes visible to job seekers. It bridges employer actions (Story 3.3) with job seeker visibility (Story 3.1).

**Key Design Decision - Status Mapping Rationale**: This story implements a crucial UX decision from AC 3: mapping technical/internal status names to user-friendly labels. The rationale:

1. **"NEW" → "Applied"**: Job seekers submitted the application, so "Applied" is more meaningful than "New"
2. **"UNDER_REVIEW" → "Under Review"**: User-friendly formatting with spaces
3. **"INTERVIEW" → "In Progress"**: More positive framing - indicates active progression rather than just "interview scheduled"
4. **"CLOSED" → "Closed"**: Neutral term (could be hired or rejected - employers decide messaging outside the platform)

This mapping provides a better user experience while maintaining the same underlying data model.

**Data Flow**:
1. Employer changes status in Story 3.3 → `Application.status` and `updatedAt` updated in database
2. Job seeker refreshes My Applications page (manual or auto-refresh)
3. Frontend fetches `GET /api/v1/applications/my-applications` with current status
4. `mapApplicationStatusToDisplay()` converts raw status to user-friendly label
5. `ApplicationCard` displays the mapped status with appropriate styling

**No Backend Schema Changes**: This story requires NO new database fields or backend endpoints. It leverages:
- Existing `Application.status` field from Story 2.4
- Existing `Application.updatedAt` timestamp from Story 3.3
- Existing `GET /api/v1/applications/my-applications` endpoint from Story 3.1

All changes are frontend presentation layer only.

**Data Models**:

No new data models needed. Uses existing:
*   **Application Model (from Story 2.4)**:
    *   `status`: `ApplicationStatus` - Already exists
    *   `updatedAt`: `Date` - Updated by Story 3.3
    *   [Source: Story 2.4 and Story 3.3]

*   **MyApplicationDto (from Story 3.1)** - Already includes status field:
    *   `status`: `ApplicationStatus`
    *   `updatedAt`: `Date`
    *   [Source: Story 3.1]

**TypeScript Interfaces**:

```typescript
// In packages/shared-types/application.ts (extending existing)

// Status display type for user-facing labels
export type ApplicationStatusDisplay =
  | 'Applied'
  | 'Under Review'
  | 'In Progress'
  | 'Closed';

// Status display configuration
export interface StatusDisplayConfig {
  label: ApplicationStatusDisplay;
  color: 'blue' | 'orange' | 'green' | 'default';
  icon?: string; // Ant Design icon name
  description?: string; // For tooltip or help text
}

// Status mapper utility (exported from utils, not types)
// export function mapApplicationStatusToDisplay(status: ApplicationStatus): ApplicationStatusDisplay
```

**Status Mapping Table**:

| Internal Status (Backend) | Display Label (Frontend) | Color | Icon | Meaning |
|--------------------------|--------------------------|-------|------|---------|
| NEW | Applied | Blue (#1890FF) | CheckCircleOutlined | Application submitted |
| UNDER_REVIEW | Under Review | Orange (#FA8C16) | EyeOutlined | Being evaluated by employer |
| INTERVIEW | In Progress | Green (#52C41A) | TeamOutlined | Interview stage (active progression) |
| CLOSED | Closed | Gray (#8C8C8C) | CloseCircleOutlined | Decision made (outcome unspecified) |

[Source: AC 3 and UX best practices]

**API Specifications**:

No new API endpoints needed. Relies on:

*   **GET /api/v1/applications/my-applications** (from Story 3.1):
    *   Already returns application status
    *   Already includes `updatedAt` timestamp (if Story 3.1 implemented it)
    *   No changes needed
    *   [Source: Story 3.1]

**Component Specifications**:

*   **ApplicationCard** (Updated from Story 3.1): Now displays user-friendly status labels using `mapApplicationStatusToDisplay()`. Shows color-coded status badge with optional icon. Includes "Recently Updated" indicator for status changes within 7 days. [Source: architecture/10-frontend-architecture.md and AC 1, 3]

*   **ApplicationsList** (Updated from Story 3.1): Filter tabs now use display labels. Sorts applications with recent updates to top. [Source: architecture/10-frontend-architecture.md and AC 1]

*   **ApplicationsStats** (Updated from Story 3.1): Statistics now display using user-friendly labels with color-coded cards. [Source: architecture/10-frontend-architecture.md and AC 3]

*   **StatusExplanationModal** (New): Modal explaining what each status means for job seekers. Accessible via help link. [Source: User education and AC 3]

**Utility Functions**:

```typescript
// In apps/web/src/utils/statusMapper.ts

/**
 * Maps internal application status to user-friendly display label
 * @param status - The internal ApplicationStatus enum value
 * @returns User-friendly status label for display
 */
export function mapApplicationStatusToDisplay(
  status: ApplicationStatus
): ApplicationStatusDisplay {
  const mapping: Record<ApplicationStatus, ApplicationStatusDisplay> = {
    NEW: 'Applied',
    UNDER_REVIEW: 'Under Review',
    INTERVIEW: 'In Progress',
    CLOSED: 'Closed',
  };
  return mapping[status];
}

/**
 * Gets the full display configuration for a status
 * @param status - The internal ApplicationStatus enum value
 * @returns StatusDisplayConfig with label, color, icon, description
 */
export function getStatusDisplayConfig(
  status: ApplicationStatus
): StatusDisplayConfig {
  const configs: Record<ApplicationStatus, StatusDisplayConfig> = {
    NEW: {
      label: 'Applied',
      color: 'blue',
      icon: 'CheckCircleOutlined',
      description: 'Your application has been submitted successfully',
    },
    UNDER_REVIEW: {
      label: 'Under Review',
      color: 'orange',
      icon: 'EyeOutlined',
      description: 'The employer is reviewing your application',
    },
    INTERVIEW: {
      label: 'In Progress',
      color: 'green',
      icon: 'TeamOutlined',
      description: 'You are progressing in the hiring process',
    },
    CLOSED: {
      label: 'Closed',
      color: 'default',
      icon: 'CloseCircleOutlined',
      description: 'A decision has been made on your application',
    },
  };
  return configs[status];
}

/**
 * Checks if application status was recently updated
 * @param updatedAt - The timestamp when status was last updated
 * @param daysThreshold - Number of days to consider "recent" (default: 7)
 * @returns true if updated within threshold
 */
export function isRecentlyUpdated(
  updatedAt: Date,
  daysThreshold: number = 7
): boolean {
  const now = new Date();
  const diffMs = now.getTime() - new Date(updatedAt).getTime();
  const diffDays = diffMs / (1000 * 60 * 60 * 24);
  return diffDays <= daysThreshold;
}
```
[Source: AC 3 and status display requirements]

**File Locations**:

*   **Backend**:
    *   No new backend files (uses existing from Story 3.1 and Story 2.4)
    *   Verify: `ApplicationService.java`, `ApplicationController.java`, `MyApplicationDto.java`

*   **Frontend**:
    *   Utilities: `apps/web/src/utils/statusMapper.ts` (new)
    *   Components: `apps/web/src/features/applications/ApplicationCard.tsx` (update from Story 3.1)
    *   Components: `apps/web/src/features/applications/ApplicationsList.tsx` (update from Story 3.1)
    *   Components: `apps/web/src/features/applications/ApplicationsStats.tsx` (update from Story 3.1)
    *   Components: `apps/web/src/features/applications/StatusExplanationModal.tsx` (new)
    *   Stores: `apps/web/src/stores/useMyApplicationsStore.ts` (update for refresh actions)

*   **Shared Types**: `packages/shared-types/application.ts` (add display types)

**Security Considerations**:

*   **Read-Only Access**: Job seekers can ONLY view their own application statuses. They cannot modify them. [Source: Story 3.1 security]
*   **User ID from JWT**: User ID extracted from JWT to fetch only their applications. [Source: Story 3.1 security patterns]
*   **No Cross-User Access**: Job seeker A cannot see Job seeker B's application statuses. [Source: Security best practice]
*   **Status Integrity**: Status values come from backend (single source of truth). Frontend only transforms for display. [Source: Data integrity]

**UX Considerations**:

*   **No Notifications (AC 2)**: Since no email/push notifications are implemented in MVP, the story focuses on passive updates when users visit the page. [Source: AC 2]
*   **Auto-Refresh**: Optional 60-second auto-refresh when page is visible provides near-real-time updates without notifications. [Source: Compensating for AC 2]
*   **Manual Refresh**: Prominent manual refresh button gives users control. [Source: User control]
*   **Recently Updated Indicator**: Visual indicator for status changes within 7 days draws attention to updates. [Source: Status change awareness]
*   **Status Explanation**: Help modal explains status meanings to reduce user confusion. [Source: AC 3 clarification]
*   **Positive Framing**: "In Progress" instead of "Interview" feels more encouraging. [Source: Positive UX]
*   **Neutral "Closed"**: Doesn't specify hired/rejected to avoid platform delivering bad news. [Source: Sensitive UX]

**Performance Considerations**:

*   **Client-Side Mapping**: Status display mapping happens on frontend for fast rendering. [Source: Performance]
*   **Auto-Refresh Throttling**: Auto-refresh only when page is in focus to save API calls. [Source: architecture/15-security-and-performance.md]
*   **Polling Interval**: 60-second interval balances freshness with server load. [Source: Performance]
*   **No Additional API Calls**: Uses existing endpoint with no performance impact. [Source: Efficiency]

**Accessibility Considerations**:

*   **WCAG AA Compliance**: Status colors have sufficient contrast. [Source: PRD accessibility requirement]
*   **Screen Readers**: Status badges include proper ARIA labels with full text. [Source: Accessibility]
*   **Color Independence**: Status also differentiated by label text, not just color. [Source: Color blindness]
*   **Keyboard Navigation**: All interactive elements (refresh, help modal) keyboard accessible. [Source: WCAG AA]

**Integration with Other Stories**:
- **Story 3.1**: Extends the My Applications page with status display logic
- **Story 3.3**: Reflects the status changes employers make
- **Story 2.4**: Uses the Application entity and status field
- **Future**: Story could be enhanced with real-time notifications (WebSocket) or email alerts

**Future Enhancements** (Not in MVP):
*   Real-time status updates via WebSocket (no polling needed)
*   Email notifications when status changes
*   Push notifications on mobile app
*   In-app notification center with status change alerts
*   Status change history timeline (requires backend schema changes)
*   Customizable notification preferences per application
*   Status change reasons/notes from employers (if employer provides them)
*   Celebrate/congratulate animations for positive status changes (e.g., moving to Interview)

**Testing**

**Unit Tests:**
*   **Backend**: Verify existing tests from Story 3.1 cover status field in responses. Add test to verify status reflects latest update. [Source: architecture/16-testing-strategy.md]
*   **Frontend**: Use Jest to test `mapApplicationStatusToDisplay()` function with all status values. Test `ApplicationCard` displays correct user-friendly labels. Test `isRecentlyUpdated()` utility. [Source: architecture/16-testing-strategy.md]

**Integration Tests:**
*   Test the complete flow: Employer changes status (Story 3.3) → Job seeker fetches applications (Story 3.1) → Verify updated status is returned → Verify correct display label mapping. [Source: architecture/16-testing-strategy.md]

**E2E Tests:**
*   Use Playwright to test full user journey: Login as employer → Change applicant status → Login as job seeker → Navigate to My Applications → Verify status displays with user-friendly label → Verify color coding → Test refresh functionality. [Source: architecture/16-testing-strategy.md]

**Change Log**

| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-11-06 | 1.0 | Initial draft based on Epic 3, Story 3.4 | Bob (SM) |

**Dev Agent Record**

**Agent Model Used**
{{agent_model_name_version}}

**Debug Log References**

**Completion Notes List**

**File List**

**QA Results**
